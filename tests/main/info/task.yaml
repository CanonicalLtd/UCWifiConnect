summary: Test wifi-connect snap returns default config

execute: |
    # Ensure all necessary plugs/slots are connected
    snap interfaces | grep -Pzq "wifi-ap:control +[a-z,\-,:\,]*wifi-connect"
    snap interfaces | grep -Pzq ":network +[a-z,\-,:\,]*wifi-connect"
    snap interfaces | grep -Pzq ":network-bind +[a-z,\-,:\,]*wifi-connect"
    snap interfaces | grep -Pzq "network-manager:service +[a-z,\-,:\,]*wifi-connect:network-manager"
    snap interfaces | grep -Pzq ":network-control +[a-z,\-,:\,]*wifi-connect"

    # Ensure all initial config is correct
    config="$(/snap/bin/wifi-connect show-ap)"
    
    [[ "$config" =~ .*debug:\ false.* ]]
    [[ "$config" =~ .*dhcp.lease-time:\ 12h.* ]]
    [[ "$config" =~ .*dhcp.range-start:\ 10.0.60.3.* ]]
    [[ "$config" =~ .*dhcp.range-stop:\ 10.0.60.20.* ]]
    [[ "$config" =~ .*disabled:\ true.* ]]
    [[ "$config" =~ .*share.disabled:\ false.* ]]
    [[ "$config" =~ .*share.network-interface:\ eth0.* ]]
    [[ "$config" =~ .*wifi.address:\ 10.0.60.1.* ]]
    [[ "$config" =~ .*wifi.channel:\ 6.* ]]
    [[ "$config" =~ .*wifi.hostapd-driver:\ nl80211.* ]]
    [[ "$config" =~ .*wifi.interface:\ wlan0.* ]]
    [[ "$config" =~ .*wifi.interface-mode:\ direct.* ]]
    [[ "$config" =~ .*wifi.netmask:\ 255.255.255.0.* ]]
    [[ "$config" =~ .*wifi.operation-mode:\ g.* ]]
    [[ "$config" =~ .*wifi.security:\ open.* ]]
    [[ "$config" =~ .*wifi.security-passphrase:\ .* ]]
    [[ "$config" =~ .*wifi.ssid:\ Ubuntu.* ]]
